<!DOCTYPE html>
<html lang="en">
  <!--ページ内以外の必要事項-->
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, width=1280">
    <title>Tomoki Kagawa's Portfolio</title>
    <link rel="stylesheet" href="./style.css">
  </head>

  <!--ヘッダー-->
  <body>
    <header class="clearfix background-color" id="Top">
      <h1 class="header-left"><a href="./index.php">Tomoki Kagawa's Portfolio</a></h1>
      <div class="header-right clearfix">
      <details>
        <summary><span><p>menu</p></span></summary>
        <ul class="background-color">
          <li><a href="#self-introduction">自己紹介</a></li>
          <li><a href="#Archives">過去の記録</a></li>
          <li><a href="#gallery">ーギャラリー</a></li>
          <li><a href="#training">ー成果物</a></li>
          <li><a href="#Contact">お問い合わせ</a></li>
        </ul>
      </details>
    </header>
    <div class="empty"></div>
    <!--成果物-->
    <div class="container deliverable">
      <h3>Arduino/C++・ブロック崩し</h3>
      <p>画像をクリックすることで作成物をご覧いただけます。</p>
      <p>上の資料が動作テスト動画で下の資料は回路図の拡大画像になっております。</p>
      <p>コードは<a href="https://github.com/Tomoki-Kagawa/dc_work_itebina_kagawa_portfolio/tree/main/htdocs/Arduino_C%2B%2B" target="_blank" class="git">
        github</a>からご覧いただけますと幸いです。</p>
    </div>
    <div class="explanatory">
      <div class="deliverable_img">
        <a href="./images/Breakingblocks2.mp4" target="_blank"><img src="./images/BreakingBlocks2.png" alt="PFC++.png"></a>
        <a href="./images/回路図.png" target="_blank"><img src="./images/回路図.png" alt="回路図.png"></a>
      </div>
      <div class="text">
        <h3>・作成期間</h3>
        <p>　2.5週間(50時間程度)</p>
        <br>
        <h3>・作成目的</h3>
        <p>　学生の頃に学んだプログラミング言語や開発環境を使って成果物を作成する。</p>
        <p>　新しく電子部品を買うための資金調達が難しいため、学生の頃に買った電子部品のみで成果物を作成する。</p>
        <br>
        <h3>・課題内容</h3>
        <p>　センサの情報で操作するブロック崩しを作成。</p>
        <p>　Arduinoでは、脈拍センサを扱ってノイズを除去した脈拍を取り、値が一番高くなった時に圧電スピーカーでビープ音を鳴らし、脈拍データをシリアル通信でubuntuへ送信。</p>
        <p>　PC側では、C++でブロック崩し、画像処理、脈拍描画の3つを行う。</p>
        <p>　Arduinoから送られてきた脈拍データでグラフを作りつつ、BPMを算出。BPMの速さによって難易度情報HighかLowをブロック崩しに送り難易度を変更。</p>
        <p>　OpenCVを使ってWebカメラで顔の認識を行い、顔の位置情報から値を算出。ブロック崩しに値を送信し、パドル操作を行う。</p>
        <p>　2つのプログラムから送られてきた情報を扱ってブロック崩しを進める。</p>
        <br>
        <h3>・工夫点</h3>
        <p>　脈拍センサから取得した脈拍情報を平滑化し、ノイズ除去をすることで波の頂点を正しく検知をできるようにした。</p>
        <p>　ArduinoからUbuntuに送られてきた脈拍情報にバッファを持たせ、情報が届き切ってから波形に反映させるようにすることで、不完全な情報による波形の崩れを防ぐようにした。</p>
        <p>　パドル操作をカメラの顔認識で行えるように顔認識の限界値に線を引き、顔認識が出来ていたら顔を四角く囲うことで検知できているか、プレイヤーにフィードバックを行うようにした。また、カメラの情報をそのまま扱うとパドル操作の左右の動きが逆に表示されたため、カメラ表示を左右反転させ、操作性を良くした。</p>
        <p>　顔認識のパドル操作が上手くいかない場合のために、キーボードのAで左に移動とDで右に移動で操作できるようにした。</p>
        <br>
        <h3>・操作手順</h3>
        <p>　yarpserverを立てる→カメラとArduinoをPCに接続→各プログラムを実行→yarp connectでプログラム間を接続→webカメラに顔が映るように移動→指先を脈拍センサで正常な値が出る様になったらスタートボタンを押す→カメラからの顔の位置によってパドルを操作</p>
        <br>
        <h3>・開発環境</h3>
        <h4>　脈拍検知</h4>
        <p>　言語/Arduino</p>
        <p>　IDE/Arduino IDE</p>
        <p>　使用部品/Arduino nano・脈拍センサ・圧電スピーカー・LCDディスプレイ</p>
        <br>
        <h4>　ブロック崩し・画像処理・脈拍描画</h4>
        <p>　言語/C++</p>
        <p>　エディタ/Vim</p>
        <p>　使用部品/ubuntu環境のPC・Webカメラ</p>
        <p>　OS/ubuntu</p>
        <p>　ビルド/CMake</p>
        <p>　フレームワーク/Qt</p>
        <p>　ライブラリ/OpenCV</p>
        <p>　通信プロトコル/YARP</p>
      </div>
    </div>
    <!--フッター-->
    <footer class="background-color">
      <p>Copyright &copy; 2025 Tomoki Kagawa</p>
    </footer>
  </body>
</html>

